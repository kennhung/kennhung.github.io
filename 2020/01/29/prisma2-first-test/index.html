<!DOCTYPE html><html lang="zh-tw"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta http-equiv="X-UA-Compatible" content="chrome=1"><meta name="renderer" content="webkit|ie-comp|ie-stand"><meta name="referrer" content="no-referrer"><meta name="theme-color" content="#333333"><meta name="mobile-web-app-capable" content="yes"><meta name="google" content="notranslate"><meta name="format-detection" content="telephone=no"><meta name="keyword" content=""><meta name="description" content=""><title>Prisma2 初探 - Kenn&#39;s Blog</title><base href="/"><link rel="preconnect" href="//cdnjs.cloudflare.com"><link rel="manifest" href="/manifest.json"><link rel="shortcut icon" href="/icons/icon-72x72.png"><link rel="apple-touch-icon" href="/icons/icon-192x192.png"><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/styles/atom-one-light.min.css" rel="stylesheet"><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/styles/atom-one-dark.min.css" rel="stylesheet" media="screen and (prefers-color-scheme:dark)"><link href="https://cdnjs.cloudflare.com/ajax/libs/uikit/3.2.0/css/uikit.min.css" rel="stylesheet"><script src="https://cdnjs.cloudflare.com/ajax/libs/uikit/3.2.0/js/uikit.min.js" async></script><script src="https://cdnjs.cloudflare.com/ajax/libs/uikit/3.2.0/js/uikit-icons.min.js" async></script><link rel="stylesheet" href="/styles/cold-stone.css"><noscript><p class="text-center">你的瀏覽器沒有啟動 Javascript 功能！</p></noscript><meta name="generator" content="Hexo 4.2.0"><link rel="alternate" href="/atom.xml" title="Kenn's blog" type="application/atom+xml"></head><body><header class="header" uk-sticky="top: 100; animation: uk-animation-slide-top; bottom: #sticky-on-scroll-up"><nav class="wrapper header-content"><div class="nav-overlay uk-navbar-left"><h1 class="title nav-list-item uk-logo" data-link="/"><a href="/" data-link="/">Kenn&#39;s blog</a></h1><ul class="nav-list"><li class="nav-list-item" data-link="/categories/"><a class="nav-list-link" href="/categories">分類</a></li><li class="nav-list-item" data-link="/about/"><a class="nav-list-link" href="/about/">關於</a></li><li class="nav-list-item" data-link="/rss/"><a class="nav-list-link" href="/atom.xml">RSS</a></li></ul></div><div class="uk-navbar-right translate-x"><a class="uk-navbar-toggle" href="#modal-full" uk-search-icon uk-toggle></a></div></nav></header><div id="modal-full" class="uk-modal-full uk-modal" uk-modal><div class="uk-modal-dialog uk-flex uk-flex-center uk-flex-middle" uk-height-viewport><button class="uk-modal-close-full" type="button" uk-close></button><form class="uk-search uk-search-large search-form" action="//google.com/search" method="get" accept-charset="UTF-8" target="_blank"><input class="uk-search-input search-form-input" type="search" name="q" placeholder="搜尋" autofocus autocomplete="false"> <input type="hidden" name="sitesearch" value="https://www.kenn.one"></form></div></div><main class="main wrapper"><article class="article slide-in-right uk-article"><section class="article-header"><h1 class="article-title uk-article-title">Prisma2 初探</h1><p class="article-meta uk-article-meta"><span class="meta-info"><span>最後更新&#58;<time class="post-time" datetime="2020-01-29">2020-01-29</time> </span><span>閱讀時間&#58; 1 min</span></span></p></section><section class="article-content"><p>參考 <strong>Getting started</strong><br><a href="https://github.com/prisma/prisma2/blob/master/docs/getting-started.md" target="_blank" rel="noopener">https://github.com/prisma/prisma2/blob/master/docs/getting-started.md</a></p><p><em>由於 Prisma2 還在 Beta 階段，之後可能會有比較大的變更。</em></p><h2 id="Getting-started"><a href="#Getting-started" class="headerlink" title="Getting started"></a>Getting started</h2><h3 id="Install-amp-Init"><a href="#Install-amp-Init" class="headerlink" title="Install &amp; Init"></a>Install &amp; Init</h3><ol><li><strong><code>npm install prisma2 --save-dev</code></strong></li><li><strong><code>npx prisma2 init</code></strong></li></ol><p>Prisma 會自動產生一個 <code>schema.prisma</code> 檔案</p><pre><code class="prisma">datasource db {
  provider = &quot;mysql&quot;
  url      = &quot;mysql://codimd:codimd@kennhuang.ddns.net:3307/codimd&quot;
}

generator client {
  provider = &quot;prisma-client-js&quot;
}</code></pre><h3 id="從資料庫抓取-Schema"><a href="#從資料庫抓取-Schema" class="headerlink" title="從資料庫抓取 Schema"></a>從資料庫抓取 Schema</h3><ol start="3"><li><strong>在 <code>schema.prisma</code> 檔案中，設定資料來源</strong></li></ol><p>Example:</p><pre><code class="prisma">datasource mysql {
  provider  = &quot;mysql&quot;
  url       = &quot;mysql://johndoe:johndoe@localhost:5432/mydb&quot;
}</code></pre><p><strong>可以<a href="https://github.com/prisma/prisma2/blob/master/docs/prisma-schema-file.md#the-env-function" target="_blank" rel="noopener">使用環境變數</a></strong></p><pre><code class="prisma">url = env(&quot;MYSQL_URL&quot;)</code></pre><p>P.S. <strong>mariadb 可以用 mysql 連接</strong></p><p>Document: <a href="https://github.com/prisma/prisma2/blob/master/docs/prisma-schema-file.md#data-sources" target="_blank" rel="noopener">prisma-schema-file</a></p><ol start="4"><li><strong><code>prisma2 introspect</code></strong></li></ol><p>這時 prisma 會依據 datasource 在<code>schema.prisma</code> 檔案中建立 schema</p><h3 id="產生-Prisma-Client"><a href="#產生-Prisma-Client" class="headerlink" title="產生 Prisma Client"></a>產生 Prisma Client</h3><ol start="5"><li><strong><code>npm install @prisma/client</code></strong></li><li><strong><code>prisma2 generate</code></strong></li></ol><h3 id="在程式碼中使用"><a href="#在程式碼中使用" class="headerlink" title="在程式碼中使用"></a>在程式碼中使用</h3><pre><code class="javascript">const { PrismaClient } = require(&#39;@prisma/client&#39;);

const prisma = new PrismaClient();</code></pre><h2 id="Prisma-2"><a href="#Prisma-2" class="headerlink" title="Prisma 2"></a>Prisma 2</h2><ul><li><a href="https://github.com/prisma/prisma-client-js" target="_blank" rel="noopener">Prisma Client JS</a> (Photon): Database Client，一個讓你可以更方便連接database的工具</li><li><a href="https://github.com/prisma/migrate" target="_blank" rel="noopener">Prisma Migrate</a> (Lift): Declarative data modeling and migrations</li><li><a href="https://github.com/prisma/studio" target="_blank" rel="noopener">Studio</a>: 透過 Prisma2 連接的 DB 管理介面</li></ul><h2 id="Prisma-2-CLI"><a href="#Prisma-2-CLI" class="headerlink" title="Prisma 2 CLI"></a>Prisma 2 CLI</h2><p><a href="https://github.com/prisma/prisma2/blob/master/docs/prisma2-cli.md" target="_blank" rel="noopener">https://github.com/prisma/prisma2/blob/master/docs/prisma2-cli.md</a></p></section></article><section class="prev-next card slide-in-right"><a class="link-disabled prev link">&larr; 沒有了</a> <a href="/2020/01/25/kenns-blog-is-online/" class="link next" title="Kenn&#39;s Blog 上線啦"><span class="hover-underline-animation">Kenn&#39;s Blog 上線啦 &rarr;</span></a></section><section class="article-toc"><div class="card uk-margin-remove-bottom"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Getting-started"><span class="toc-text">Getting started</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Install-amp-Init"><span class="toc-text">Install &amp; Init</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#從資料庫抓取-Schema"><span class="toc-text">從資料庫抓取 Schema</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#產生-Prisma-Client"><span class="toc-text">產生 Prisma Client</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#在程式碼中使用"><span class="toc-text">在程式碼中使用</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Prisma-2"><span class="toc-text">Prisma 2</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Prisma-2-CLI"><span class="toc-text">Prisma 2 CLI</span></a></li></ol></div></section><section class="article slide-in-right"><div class="loader" id="loader"><svg viewBox="0 0 50 50"><circle class="ring" cx="25" cy="25" r="20"></circle><circle class="ball" cx="25" cy="5" r="3.5"></circle></svg></div><div class="comment" id="utteranc"></div><noscript>Please activate JavaScript for normal use of comments</noscript></section><a class="card back-to-top" id="backTop">&UpArrow;</a></main><script>window.COLD_STONE={root:"/",author:"KennHuang",gaid:"xxxxxxxxxxxxxx",repo:"kennhung/kennhung.github.io"}</script><script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/highlight.min.js"></script><script>hljs.initHighlightingOnLoad()</script><script src="/scripts/cold-stone.js"></script><script src="//www.googletagmanager.com/gtag/js?id=xxxxxxxxxxxxxx"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config",window.COLD_STONE.gaid)</script></body></html>